
  <div ng-include="'comps/common/topbar.html'">
  </div>

  <div class="modal fade" id="addPedidoModal" tabindex="-1" role="dialog" aria-labelledby="addPedidoModalLabel" aria-hidden="true" style="overflow: hidden !important;" >
    <div class="modal-dialog  mw-100  modal-90 modal-100-ht" role="document">
      <div class="modal-content">
        <div class="modal-header" style="background: #399CDF;color: white; font-weight: bold; padding: 7px !important;, margin-bottom: 10px;">
          <h5 class="modal-title" id="addPedidoModalLabel">Crear Pedido 
            <!-- <i class="fas fa-check" style="color:#8f9791" ></i> -->
          </h5>

          <button type="button" class="close" ng-click="closeModalOrder()" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>

        <div class="modal-body" id="addPedidoModalBody">


          <!-- <ul class="nav nav-tabs mb-2 mt-2 " style="margin-bottom:0px !important" > 
              <li class="nav-item" ng-show="1 == 2" >
                <a class="nav-link " ng-class="{ active : tabsIndex == 0 }" ng-click="goToTab(0)" >Información Cliente </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" ng-class="{ active : tabsIndex == 1, disabled: !clienteValido  }" ng-disabled=" !clienteValido" ng-click="goToTab(1)" >Detalle de pedido </a>
              </li>
          </ul> -->

          <div class="controlAction" ng-show="tabsIndex == 1" >

            <div class="col-md-12 row" style="padding-left: 0px;" >

              <div class="col-md-4 dropdown"  ng-show="!clienteEmpleado && ID != null">
                <button class="btn btn-info dropdown-toggle" style="
                background-color: #72797f;
                color: #fff;
                border: gray;" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  Tipo de pedido
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="dropdown-item" ng-click="pickUpAvailable='1'" >Pedido normal</a>
                  <a class="dropdown-item" ng-click="pickUpAvailable='2'" >Pedido Pick-Up</a>
                </div>
                <div class="inputTIPO" style="display: inline-block;">

                  <input type="text" style="
                  height: 37px;
                  padding: 1px 3px 3px;" class="form-control" placeholder="Text input" disabled value="{{(pickUpAvailable=='1')? 'Pedido normal':'Pedido Pick-Up' }}">
                </div>
                

              </div>

              <div class="col-md-4"  ng-show="clienteEmpleado && ID != null">

                <button class="btn btn-info dropdown-toggle" ng-disabled="pedido.pedido.length > 0" style="
                background-color: #72797f;
                color: #fff;
                
                border: gray;" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  Tipo de pedido
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="dropdown-item" ng-click="seleccinaTipoPedido('01')" >Pedido Regular </a>
                  <a class="dropdown-item" ng-click="seleccinaTipoPedido('96')" >Pedido Especial</a>
                </div>
                <div class="inputTIPO" style="display: inline-block;">

                  <input type="text" style="
                  height: 37px;
                  padding: 1px 3px 3px;" class="form-control" placeholder="Text input" disabled value="{{(tipoPedidoSearch=='01')? 'Pedido Regular':'Pedido Especial' }}">
                </div>

                <!-- <label for="filtro">Tipo de pedido</label>
                <div class="input-group mb-3 ">
                  <div class="form-group">
                    <select class="form-control" ng-disabled="pedido.pedido.length > 0" ng-model="tipoPedidoSearch" id="tipoPedidoSearch"  data-live-search="true" >
                      
                      <option  value="01" selected>
                        Pedido Regular 
                      </option>
                      <option  value="96">
                        Pedido Especial
                      </option>
                    </select>
                  </div>
                </div> -->
    
              </div>

              <div class="col-md-2">
                <button type="button" style="width: 100%;" class="btn btn-info"  ng-show="ID != null" ng-click="openModalProducts()" ><i class="fas fa-plus"  ></i> <span>Agregar productos</span> </button>
              </div>

              <div class="col-md-2">
                <button type="button" style="width: 100%;" class="btn btn-success" ng-click="openModalDyn(0,ID)" ng-show="ID != null" ng-disabled="pedido.pedido.length < 1 || !clienteValido" ><i class="fas fa-check"  ></i > <span> Finalizar pedido</span></button>
              </div>
              <div class="col-md-2">
                <button type="button" style="width: 100%;" class="btn btn-info"  ng-show="ID != null && !clienteEmpleado" data-toggle="modal" data-target="#modalOferta" ><i class="fas fa-plus"  ></i> <span>Ver ofertas</span> </button>
              </div>


            </div>
          </div>


          <div class="modal-body-he">

            <form class="row col-sm-12 col-md-12 col-lg-12" >

              <div class="col-sm-12 col-md-12 col-lg-12" ng-show="tabsIndex == 0" >
                <!-- INFO CLIENTE -->
                <!-- <header-client></header-client> -->
                <!--  END INFO CLIENTE -->
                <div ng-show="!hasUserClient">

                  <div ng-if="clientIndex != null">
                    <header-client cliente="client" ></header-client>
                  </div>

                </div>

              <div class="row">
                <div class="col-sm-12 col-md-6 col-lg-6" style="display: none;">
                  <div class="form-group">
                    <label>Factura</label>
                    <input type="text" ng-model="pedido.no_factu" class="form-control" placeholder="no_factura">
                  </div>
                </div>
                <div class="col-sm-12 col-md-4 col-lg-4">
                  <div class="form-group">
                    <label>Fecha</label>
                    <!-- <input type="date" ng-disabled="true" ng-model="pedido.fecha" class="form-control" placeholder="fecha"> -->
                  </div>
                </div>
                <div class="col-sm-12 col-md-8 col-lg-8">


                  <div class="form-group">
                    <label for="comment">Observacion del pedido</label>
                    <textarea class="form-control" ng-model="pedido.observacion" rows="2" id="comment"></textarea>
                  </div>
                </div>


              </div>


              </div>

              <div class="col-sm-12 col-md-12 col-lg-12" ng-show="tabsIndex == 1" >


                


                <div class="row" >

                  <div class="col-md-6 col-sm-12 " ng-show=" clienteEmpleado"  style="font-size: 12px;" >
                    <div ng-show=" clienteEmpleado" class="row">
                      <div class="col-md-3 col-sm-12">
                          <label>Máx. unidades medicina</label><br>
                          <span >{{client.max_unid_med_emp}}</span>
    
                        </div>
                        <div class="col-md-3 col-sm-12">
                          <label>Máx. unidades misceláneos</label><br>
                          <span >{{client.max_unid_misc_emp}}</span>
    
                        </div>
                        <div class="col-md-3 col-sm-12">
                          <label>Disp. unidades medicina</label><br>
                          <span >{{client.unid_disp_med_emp - totales.empMed}}</span>
    
                        </div>
                        <div class="col-md-3 col-sm-12">
                          <label>Disp. unidades misceláneos</label><br>
                          <span >{{client.unid_disp_misc_emp - totales.empMisc}}</span>
    
                        </div>
                  </div>
                  </div>

                  <div class="col-md-6 col-sm-12 " style="font-size: 12px;" >

                    <div class="col-md-4 col-sm-12" >
                      <div ng-show="pickUpAvailable == '2'" >
                        <label>Monto mínimo pick - up</label><br>
                        <span >{{formato(2,client.monto_min_pick)? formato(2, client.monto_min_pick):0}}</span>
                      </div>
                    </div>

                    <div class="col-md-4 col-sm-12">
                      <label>Monto mínimo pedido</label><br>
                      <span >{{formato(2,client.monto_minimo)? formato(2, client.monto_minimo):0}}</span>
  
                    </div>
                    <div class="col-md-4 col-sm-12">
                      <label>Crédito disponible</label><br>
                      <span >{{formato(2,(creditoClient.disp_bs_format)? (creditoClient.disp_bs_format - totales.bsConIva):0)}}</span>
                      <br>
                      <span >{{formato(3,(creditoClient.disp_usd_format)? (creditoClient.disp_usd_format - totales.UsdConIva):0)}}</span>

                    </div>


                  </div>

                  <div class="col-md-12">
                    <div class="col-md-2 float-right">
                      <button type="button" style="width: 100%;" class="btn btn-info "  ng-show="ID != null" ng-click="closeModalOrder(true)" ><i class="fas fa-trash"  ></i> <span>Eliminar Pedido</span> </button>
                    </div>
                  </div>

                </div>




                <div class="form-group" >

                  <table class="table table-striped table-bordered tablaTotales" datatable="ng" dt-options="dtOrderDetalil"  >
                    <!-- <table class="table table-striped table-bordered"  datatable="ng" dt-options="dtOptionsDetalil"> -->
                      <thead>
                          <tr>
                          <!-- <th scope="col"><p class="text-center">#</p></th> -->
                          <!-- <th scope="col"><p class="text-center">Código de Articulo</p></th> -->
                          <th scope="col"><p class="text-center">Nombre artículo</p></th>
                          <th scope="col"><p class="text-center">Cantidad</p></th>
                          <th scope="col"><p class="text-center">Precio por unidad</p></th>
                          <th scope="col"><p class="text-center">Total</p></th>
                          <th scope="col"><p class="text-center">Precio USD</p></th>
                          <th scope="col"><p class="text-center">Total USD</p></th>
                          <th scope="col"><p class="text-center">Fecha vencimiento</p></th>
                          <!-- <th scope="col"><p class="text-center">Estatus</p></th> -->
                          <th scope="col"><p class="text-center">Opción</p></th>

                          </tr>
                      </thead>
                      <tbody>

                          <tr ng-repeat="x in pedido.pedido" ng-class="{ incideRow : x.alert }" >
                              <td><p class="text-left">{{ x.nombre_producto }}</p></td>
                              <td>
                                <p class="text-left">{{ x.CANTIDAD }}</p>
                              </td>
                              <td><p class="text-right">{{ formato(2,x.precio_neto_bs) }}</p></td>
                              <td><p class="text-left">{{ formato(2,(x.precio_neto_bs * x.CANTIDAD)) }}</p></td>
                              <td><p class="text-right">{{ formato(3,x.precio_neto_usd) }}</p></td>
                              <td><p class="text-right">{{ formato(3,(x.precio_neto_usd * x.CANTIDAD)) }}</p></td>
                              <td><p class="text-right">{{ x.fecha_vence}}</p></td>
                              <!-- <td><p class="text-right"><i ng-show="!x.alert" class="fas fa-1x fa-check"></i><i ng-show="x.alert"  class="fas fa-1x fa-times"></i>  </p></td> -->
                              <td >
                                <i class="fa fa-trash" style="cursor: pointer;"  ng-click="openModalDyn(3,$index)" ></i>
                                <i class="fa fa-edit" style="cursor: pointer;"  ng-click="editRow(x, $index);" ></i>
                                <!-- <button type="button" class="btn btn-danger" ng-click="openModalDyn(3,$index);" ><i class="fa fa-trash" style="cursor: pointer;" ></i></button> -->
                                <!-- <button type="button" class="btn btn-success" ng-click="editRow(x, $index);" ><i class="fa fa-edit" style="cursor: pointer;" ></i></button> -->
                              </td>
                            </tr>
                      </tbody>
                      </table>

                      <div ng-if="ID != null" class="row">
                        <div class="col-lg-2 col-sm-5">
                          </div>
                            <div class="col-lg-6 col-sm-6 ml-auto">
                                <table class="table table-clear tablaTotales">
                                    <tbody>
                                          <tr>
                                            <td class="right">
                                                <strong class="text-dark">TOT. UNID. PEDIDO :</strong> </td>
    
                                                <td class="right">{{totales.totalUnidades}} </td>
                                        </tr>
                                            <tr ng-if=" totalesDdo.desc_volumen > 0">
                                              <td class="right">
                                                  <strong class="text-dark">TOT. DESC. PP1. {{totalesDdo.porcVol}} %:</strong> </td>
    
                                                  <td class="right">{{formato(2,totalesDdo.desc_volumen)}} </td>
                                          </tr>
                                          <tr ng-if=" totalesDdo.desc_dpp > 0">
                                            <td class="right">
                                                <strong class="text-dark">TOT. DESC. PP2. {{totalesDdo.porcPP}} %:</strong> </td>
    
                                                <td class="right">{{formato(2,totalesDdo.desc_dpp)}} </td>
                                        </tr>
                                        <tr ng-if=" totalesDdo.descPreEmpaque > 0">
                                          <td class="right">
                                              <strong class="text-dark">TOT. DESC. PREEMP. :</strong> </td>
    
                                              <td class="right">{{formato(2,totalesDdo.descPreEmpaque)}} </td>
                                      </tr>
                                      <tr ng-if=" totalesDdo.descInternet > 0"> 
                                        <td class="right">
                                            <strong class="text-dark">TOT. DESC. WEB. {{totalesDdo.porcInternet}} %:</strong> </td>
  
                                            <td class="right">{{formato(2,totalesDdo.descPreEmpaque)}} </td>
                                      </tr>
                                        <tr>
                                            <td class="right">
                                                <strong class="text-dark">SUB.T. (E):</strong> </td>
    
                                                <td class="right">{{formato(2,totalesDdo.totalExento)}} </td>
                                        </tr>
                                        <tr>
                                          <td class="right">
                                              <strong class="text-dark">SUB.T. (G):</strong> </td>
    
                                              <td class="right">{{formato(2,totalesDdo.totalGravado)}} </td>
                                        </tr>
                                        <tr ng-if="totalesDdo.descImpuesto != null || totalesDdo.impuesto > 0">
                                            <td class="right">
                                              
                                                <strong class="text-dark">{{totalesDdo.descImpuesto }} </strong> </td>
    
                                                <!-- <td class="right">% {{totalesDdo.impuesto }} {{formato(2,totalesDdo.descImpuesto)}} </td> -->
                                                <td class="right"> {{formato(2,totalesDdo.impuesto) }} </td>
                                        </tr>
                                        <tr>
                                            <td class="right">
                                                <strong class="text-dark">TOTAL Bs.:</strong> </td>
    
                                                <td class="right"> {{formato(2,totalesDdo.total)}} </td>
                                        </tr>
                                        <tr>
                                          <td class="right">
                                              <strong class="text-dark">TOTAL USD:</strong> </td>
    
                                              <td class="right"> {{ formato(3,totalesDdo.totalNetoUSD) }}  </td>
                                      </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                </div>


              </div>

            </form>

          </div>
        </div>
        <div class="modal-footer" style="display: block;margin: 0 auto;">
          <button type="button" class="btn btn-info"  ng-click="closeModalOrder()">Regresar</button>
          <button type="button"  class="btn btn-success" ng-click="openModalDyn(0,ID)" ng-show="ID != null" ng-disabled="pedido.pedido.length < 1 || !clienteValido" >Finalizar pedido</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="showPedidoModal" tabindex="-1" role="dialog" aria-labelledby="showPedidoModalLabel" aria-hidden="true" style="overflow: hidden !important;">
    <div class="modal-dialog  mw-100  modal-90 modal-100-ht" role="document">
      <div class="modal-content">
        <div class="modal-header" style="background: #399CDF;color: white; font-weight: bold; padding: 7px !important;, margin-bottom: 10px;">
          <h5 class="modal-title" id="addPedidoModalLabel">VER PEDIDO <i class="fas fa-1x fa-list-alt"></i></h5>
          <button type="button" class="close" ng-click="closeModalOrder()" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
          <!-- <button type="button" class="btn btn-secondary" data-dismiss="modal" ng-click="reset();">Regresar</button> -->
        </div>
        <div class="modal-body" id="showPedidoModalBody">
          <!-- <div class="card-header mb-3">
            Fecha:
            <strong>{{pedido.fecha}}</strong>
            <span class="float-right ml-3" ng-show="editView" >
            </span>
            <span class="float-right"> <strong>Estatus:</strong> {{pedido.estatus}}</span>
            </div> -->
            <!-- <ul class="nav nav-tabs">
                <li class="nav-item" ng-show="1 == 2" >
                  <a class="nav-link " ng-class="{ active : tabsIndex == 0 }" ng-click="goToTab(0)" >Información Cliente </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" ng-class="{ active : tabsIndex == 1 }" ng-disabled="!showProductTable || !clienteValido" ng-click="goToTab(1)" >Detalle de pedido </a>
                </li>
                <li class="nav-item" ng-show="pedido.errores.length > 0">
                  <a class="nav-link" ng-class="{ active : tabsIndex == 2 }" ng-disabled="!showProductTable || !clienteValido" ng-click="goToTab(2)" >Errores</a>
                </li>
            </ul> -->

            <div class="controlAction" ng-show="tabsIndex == 1 && editView"  >

                <div class="col-md-12 row" style="padding-left: 0px;" >

                  <div class="col-md-4 dropdown"  ng-show="editView && !clienteEmpleado" >
                    <button class="btn btn-info dropdown-toggle" style="
                    background-color: #72797f;
                    color: #fff;
                    border: gray;" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      Tipo de pedido
                    </button>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                      <a class="dropdown-item" ng-click="pickUpAvailable='1'" >Pedido normal</a>
                      <a class="dropdown-item" ng-click="pickUpAvailable='2'" >Pedido Pick-Up</a>
                    </div>
                    <div class="inputTIPO" style="display: inline-block;">
    
                      <input type="text" style="
                      height: 37px;
                      padding: 1px 3px 3px;" class="form-control" placeholder="Text input" disabled value="{{(pickUpAvailable=='1')? 'Pedido normal':'Pedido Pick-Up' }}">
                    </div>
                    
    
                  </div>

                  <div class="col-md-4"  ng-show="editView && clienteEmpleado" >

                    <button class="btn btn-info dropdown-toggle" ng-disabled="pedido.pedido.length > 0" style="
                      background-color: #72797f;
                      color: #fff;
                      
                      border: gray;" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Tipo de pedido
                      </button>
                      <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                        <a class="dropdown-item" ng-click="seleccinaTipoPedido('01')" >Pedido Regular </a>
                        <a class="dropdown-item" ng-click="seleccinaTipoPedido('96')" >Pedido Especial</a>
                      </div>
                      <div class="inputTIPO" style="display: inline-block;">

                        <input type="text" style="
                        height: 37px;
                        padding: 1px 3px 3px;" class="form-control" placeholder="Text input" disabled value="{{(tipoPedidoSearch=='01')? 'Pedido Regular':'Pedido Especial' }}">
                      </div>
                    <!-- <label for="filtro">Tipo de pedido</label>
                    <div class="input-group mb-3 ">
                      <div class="form-group">
                        <select class="form-control"  ng-disabled="pedido.pedido.length > 0" ng-model="tipoPedidoSearch" id="tipoPedidoSearch" data-live-search="true" >
                         
                          <option  value="01" selected>
                            Pedido Regular 
                          </option>
                          <option  value="96">
                            Pedido Especial
                          </option>
                        </select>
                      </div>
                    </div> -->
        
                  </div>
    
                  <div class="col-md-2">
                    <button type="button" style="width: 100%;" class="btn btn-info "  ng-show="ID != null" ng-click="openModalProducts()" >Agregar productos</button>
                  </div>
    
                  <div class="col-md-2">
                    <button type="button" style="width: 100%;" class="btn btn-success" ng-click="openModalDyn(0,ID)" ng-show="ID != null" ng-disabled="pedido.pedido.length < 1 || !clienteValido" >Finalizar pedido</button>
                  </div>

                  <div class="col-md-3">
                    <button type="button" style="width: 100%;" class="btn btn-info"  ng-show="ID != null && !clienteEmpleado" data-toggle="modal" data-target="#modalOferta" > <span>Ver ofertas</span> </button>
                  </div>
    

    
                </div>
              </div>

            <div class="modal-body-he">


              <form class="col-sm-12 col-md-12 col-lg-12">

              <div class="col-sm-12 col-md-12 col-lg-12" ng-show="tabsIndex == 0"  >
                <!-- <header-client></header-client> -->
                <div ng-show="!hasUserClient">

                  <div ng-if="clientIndex != null">
                    <header-client cliente="client" ></header-client>
                  </div>



                </div>

                <div class="row">
                  <div  style="display: none;">
                    <div class="form-group">
                      <label>Factura</label>
                      <input type="text" ng-model="pedido.no_factu" class="form-control" placeholder="no_factura">
                    </div>
                  </div>
                  <div class="col-sm-12 col-md-4 col-lg-4" style="display: none;">
                    <div class="form-group">
                      <label>Fecha</label>
                      <!-- <input type="date" ng-disabled="true" ng-model="pedido.fecha" class="form-control" placeholder="fecha"> -->
                    </div>
                  </div>
                  <div class="col-sm-12 col-md-12 col-lg-12">


                    <div class="form-group">
                      <label for="comment">Observacion del pedido</label>
                      <textarea class="form-control" ng-disabled="!editView" ng-model="pedido.observacion" rows="2" id="comment"></textarea>
                    </div>
                  </div>
                </div>


              <!-- </div> -->

              </div>

              <div class="col-sm-12 col-md-12 col-lg-12"   ng-show="tabsIndex == 1"  >


                <div class="row" >

                    <div class="col-md-6 col-sm-12 row"  ng-show="editView && clienteEmpleado"  style="font-size: 12px;" >
                        <div ng-show="editView && clienteEmpleado" class="row">
                            <div class="col-md-3 col-sm-12">
                                <label>Máx. unidades medicina</label><br>
                                <span >{{client.max_unid_med_emp}}</span>
          
                              </div>
                              <div class="col-md-3 col-sm-12">
                                <label>Máx. unidades misceláneos</label><br>
                                <span >{{client.max_unid_misc_emp}}</span>
          
                              </div>
                              <div class="col-md-3 col-sm-12">
                                <label>Disp. unidades medicina</label><br>
                                <span >{{client.unid_disp_med_emp - totales.empMed}}</span>
          
                              </div>
                              <div class="col-md-3 col-sm-12">
                                <label>Disp. unidades misceláneos</label><br>
                                <span >{{client.unid_disp_misc_emp - totales.empMisc}}</span>
          
                              </div>
                        </div>
                    </div>
  
                    <div class="col-md-6 col-sm-12 " style="font-size: 12px;" >
                      <div ng-show="editView " class="row">
                        <div class="col-md-4 col-sm-12" >
                          <div ng-show="pickUpAvailable == '2'" >
                            <label>Monto mínimo pick - up</label><br>
                            <span >{{formato(2,client.monto_min_pick)? formato(2, client.monto_min_pick):0}}</span>
                          </div>
                        </div>
    
                        <div class="col-md-4 col-sm-12">
                          <label>Monto mínimo pedido</label><br>
                          <span >{{formato(2,client.monto_minimo)? formato(2, client.monto_minimo):0}}</span>
      
                        </div>
                        <div class="col-md-4 col-sm-12">
                          <label>Crédito disponible</label><br>
                          <span >{{formato(2,(creditoClient.disp_bs_format)? (creditoClient.disp_bs_format - totales.bsConIva):0)}}</span>
                          <br>
                          <span >{{formato(3,(creditoClient.disp_usd_format)? (creditoClient.disp_usd_format - totales.UsdConIva):0)}}</span>
    
                        </div>
                      </div>
  
  
                    </div>

                    <div class="col-md-12">
                      <div class="col-md-2 float-right">
                        <button type="button" style="width: 100%;" class="btn btn-info "  ng-show="ID != null && editView" ng-click="closeModalOrder(true)" ><i class="fas fa-trash"  ></i> <span>Eliminar Pedido</span> </button>
                      </div>
                    </div>
  
                  </div>

                <div class="form-group">

                          <div ng-show="!editView" >
                            <span >{{pedido.ofertas.mensaje}}</span>
                          </div>
                      <!-- <table class="table table-striped table-bordered"  datatable="ng" dt-options="dtOptionsDetalil"> -->
                          <table class="table table-striped table-bordered tablaTotales" datatable="ng" dt-options="dtOrderDetalil"  >
                          <thead>
                              <tr>
                              <!-- <th scope="col"><p class="text-center">#</p></th> -->
                              <!-- <th scope="col"><p class="text-center">Código de Articulo</p></th> -->
                              <th scope="col"><p class="text-center">Nombre artículo</p></th>
                              <th scope="col"><p class="text-center">Cantidad</p></th>
                              <th scope="col"><p class="text-center">Precio por unidad</p></th>
                              <th scope="col"><p class="text-center">Total</p></th>
                              <th scope="col"><p class="text-center">Precio USD</p></th>
                              <th scope="col"><p class="text-center">Total USD</p></th>
                              <th scope="col"><p class="text-center">Fecha vencimiento</p></th>
                              <th scope="col"><p class="text-center">Opción</p></th>

                              </tr>
                          </thead>
                          <tbody>

                              <tr ng-repeat="x in pedido.pedido" ng-class="{ incideRow : x.alert }" >
                                  <!-- <th scope="row">{{ $index + 1 }}</th> -->
                                  <!-- <td><p class="text-center">{{ x.COD_PRODUCTO }}</p></td> -->
                                  <td><p class="text-left">{{ x.nombre_producto }}</p></td>
                                  <td><p class="text-right">{{ x.CANTIDAD }}</p></td>
                                  <td><p class="text-right">{{ formato(2,x.precio_neto_bs) }}</p></td>
                                  <td><p class="text-right">{{ formato(2,(x.precio_neto_bs * x.CANTIDAD)) }}</p></td>
                                  <td><p class="text-right">{{ formato(3,x.precio_neto_usd) }}</p></td>
                                  <td><p class="text-right">{{ formato(3,(x.precio_neto_usd * x.CANTIDAD)) }}</p></td>
                                  <td><p class="text-right">{{ x.fecha_vence }}</p></td>
                                  <!-- <td><p class="text-right"><i ng-show="!x.alert" class="fas fa-1x fa-check"></i><i ng-show="x.alert"  class="fas fa-1x fa-times"></i>  </p></td> -->
                                  <td >

                                    <i class="fa fa-trash" style="cursor: pointer;"   ng-disabled="!editView" ng-show="editView"  ng-click="openModalDyn(3,$index);" ></i>
                                    <i class="fa fa-edit" style="cursor: pointer;"  ng-disabled="!editView" ng-show="editView" ng-click="editRow(x, $index);"></i>

                                    <!-- <button type="button" class="btn btn-danger" ng-disabled="!editView" ng-show="editView"  ng-click="openModalDyn(3,$index);" ><i class="fa fa-trash" style="cursor: pointer;" ></i></button>
                                    <button type="button" class="btn btn-success" ng-disabled="!editView" ng-show="editView" ng-click="editRow(x, $index);" ><i class="fa fa-edit" style="cursor: pointer;" ></i></button> -->
                                  </td>
                                </tr>
                          </tbody>
                          </table>
                          <div class="row">
                            <div class="col-lg-2 col-sm-5">
                              </div>
                                <div class="col-lg-6 col-sm-6 ml-auto">
                                    <table class="table table-clear tablaTotales" >
                                        <tbody>
                                            
                                            <tr>
                                              <td class="right">
                                                  <strong class="text-dark">TOT. UNID. PEDIDO :</strong> </td>
        
                                                  <td class="right">{{totales.totalUnidades}} </td>
                                          </tr>
                                              <tr ng-if=" totalesDdo.desc_volumen > 0">
                                                <td class="right">
                                                    <strong class="text-dark">TOT. DESC. PP1. {{totalesDdo.porcVol}} %:</strong> </td>
        
                                                    <td class="right">{{formato(2,totalesDdo.desc_volumen)}} </td>
                                            </tr>
                                            <tr ng-if=" totalesDdo.desc_dpp > 0">
                                              <td class="right">
                                                  <strong class="text-dark">TOT. DESC. PP2. {{totalesDdo.porcPP}} %:</strong> </td>
        
                                                  <td class="right">{{formato(2,totalesDdo.desc_dpp)}} </td>
                                          </tr>
                                          <tr ng-if=" totalesDdo.descPreEmpaque > 0">
                                            <td class="right">
                                                <strong class="text-dark">TOT. DESC. PREEMP. :</strong> </td>
        
                                                <td class="right">{{formato(2,totalesDdo.descPreEmpaque)}} </td>
                                        </tr>
                                        <tr ng-if=" totalesDdo.descInternet > 0"> 
                                          <td class="right">
                                              <strong class="text-dark">TOT. DESC. WEB. {{totalesDdo.porcInternet}} %:</strong> </td>
    
                                              <td class="right">{{formato(2,totalesDdo.descPreEmpaque)}} </td>
                                        </tr>
                                            <tr>
                                              <td class="right">
                                                  <strong class="text-dark">SUB.T. (E):</strong> </td>
        
                                                  <td class="right">{{formato(2,totalesDdo.totalExento)}} </td>
                                          </tr>
                                          <tr>
                                            <td class="right">
                                                <strong class="text-dark">SUB.T. (G):</strong> </td>
        
                                                <td class="right">{{formato(2,totalesDdo.totalGravado)}} </td>
                                          </tr>
                                          <tr ng-if="totalesDdo.descImpuesto != '' || totalesDdo.impuesto > 0">
                                            <td class="right">
                                                <strong class="text-dark">{{totalesDdo.descImpuesto }} </strong> </td>
        
                                                <!-- <td class="right">% {{totalesDdo.impuesto }} {{formato(2,totalesDdo.descImpuesto)}} </td> -->
                                                <td class="right"> {{formato(2,totalesDdo.impuesto) }} </td>
                                        </tr>
                                          <tr>
                                            <td class="right">
                                                <strong class="text-dark">TOTAL Bs.:</strong> </td>
        
                                                <td class="right"> {{formato(2,totalesDdo.total)}} </td>
                                        </tr>
                                        <tr>
                                          <td class="right">
                                              <strong class="text-dark">TOTAL USD:</strong> </td>
        
                                              <td class="right"> {{ formato(3,totalesDdo.totalNetoUSD) }}  </td>
                                      </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                </div>

                  



              </div>

              <div class="col-sm-12 col-md-12 col-lg-12" ng-show="tabsIndex == 2"  >

                <div class="col-12 col-sm-12 col-md-12 col-lg-12">

                      <table class="table">
                          <thead>
                              <tr>
                              <!-- <th scope="col"><p class="text-center">#</p></th> -->
                              <th scope="col"><p class="text-center">Código de Articulo</p></th>
                              <th scope="col"><p class="text-center">Descripcion</p></th>
                              <th scope="col"><p class="text-center">Fecha</p></th>


                              </tr>
                          </thead>
                          <tbody>

                              <tr ng-repeat="x in pedido.errores" ng-class="{ incideRow : x.alert }" >
                                  <!-- <th scope="row">{{ $index + 1 }}</th> -->
                                  <td><p class="text-left">{{ x.COD_PRODUCTO }}</p></td>
                                  <td><p class="text-left">{{ x.DESCRIPCION }}</p></td>
                                  <td><p class="text-left">{{ x.FECHA }}</p></td>

                                </tr>
                          </tbody>
                          </table>
                </div>

              </div>



              </form>

            </div>
        </div>

          <div class="modal-footer" style="display: block;margin: 0 auto;">
            <button type="button" class="btn btn-info" ng-click="closeModalOrder()">Regresar</button>
            <button type="button"  class="btn btn-primary"  ng-if="userLogged.permisos.pedido.editar" ng-show="!editView && (pedido.estatus_id < 3 || pedido.estatus_id == 6 ) "   ng-disabled="!clienteValido"  ng-click="editPedido();">Editar</button>
            <button type="button"  class="btn btn-success" ng-show="editView && (pedido.estatus_id < 2 || pedido.estatus_id == 6)"  ng-disabled="pedido.pedido.length < 1 || !clienteValido"  ng-click="openModalDyn(0,ID)" >Finalizar pedido</button>

            <!-- <button type="button"  class="btn btn-success" ng-disabled="pedido.pedido.length < 1" ng-show="editView" ng-click="updPedido();">Actualizar pedido</button> -->
          </div>
        </div>
      </div>
  </div>

  <div class="modal fade" id="modalproduct">
    <div class="modal-dialog mw-100  modal-90 modal-100-ht">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Agregar productos <span ng-show="clienteEmpleado" >{{(tipoPedidoSearch=='01' )? '- Pedido Regular':'- Pedido Especial' }}</span> </h4>
         
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true" ng-click="closeModalProducts()" >&times;</button>

        </div>
        <div class="modal-body">

          <div class="row">

            <div class="col-md-2">
            <label for="tipoBusqueda">Tipo de búsqueda</label>
            <div class="input-group mb-3 ">
              <div class="form-group">
                <select class="form-control " ng-model="tipoBusqueda" id="tipoBusqueda" data-live-search="true" >
                  <option  value="1" >
                    Por producto
                  </option>
                  <option  value="2">
                    Por principio activo
                  </option>
                </select>
              </div>
            </div>
          </div>
          
                  <div class="col-md-2">
            <label for="filtro">Filtrar por existencia</label>
            <div class="input-group mb-3 ">
              <div class="form-group">
                <!-- <label for="exampleFormControlSelect1">Seleccione</label> -->
                <select class="form-control   " ng-disabled="tipoPedidoSearch=='96'" ng-model="filtroExistencia" id="proveedor" data-live-search="true" >
                  <!-- <option value="null" >Todos</option> -->
                  <option  value="0" selected>
                    Todos
                  </option>
                  <option  value="2">
                    Solo con stock disponible
                  </option>
                </select>
              </div>
            </div>

          </div>

          <div class="col-md-3">
            <label for="clientes">Búsqueda </label>
            <div class="input-group mb-3 ">
              <input type="text" class="form-control"
              ng-model="busqueda_prod"
              ng-keydown="$event.keyCode === 13 && getProdNew(true)"
              placeholder="Búsqueda del producto"
              aria-label="Búsqueda del producto"
              id="busquedaProd"
              aria-describedby="basic-addon2">
              <div class="input-group-append">
                <button class="btn btn-outline-secondary"   ng-click="getProdNew(true)" type="button">Buscar</button>
              </div>
            </div>
          </div>
          <div class="col-md-1" >
            <div ng-show="pedido.pedido.length > 0 "   >
              <label></label>
              <button type="button" class="btn btn-primary mt-2" data-toggle="modal" data-target="#shoppingCart"  style="width: 100%;" ><i class="fas fa-shopping-cart"  ></i></button>
            </div>
          </div>
          </div>
          <div class="row">
              <div class="col-md-2">
                <div class="form-check" style=" padding-bottom: 25px;">
                  
                  <input type="checkbox" class="form-check-input" id="exampleCheck1" ng-disabled="tipoPedidoSearch=='96'"   ng-model="mostrarImagenges" >
                  <label class="form-check-label" for="exampleCheck1">Mostrar imagenes</label>
                </div>
              </div>

              <div class="col-md-3">

                <div class="form-check" style="padding-bottom: 25px;">
                  
                  <input type="checkbox" class="form-check-input" id="exampleCheck2" data-toggle="collapse" data-target="#collapseSearch" aria-expanded="false" aria-controls="collapseSearch"  >
                  <label class="form-check-label" for="exampleCheck2">Busqueda avanzada</label>
                </div>
              </div>

              <div class=" col-md-12">


                <div class="collapse row" id="collapseSearch">
                  <div class="col-md-3">
                    <label for="proveedor">Filtrar por proveedor</label>
                    <div class="input-group mb-3 ">
                      <div class="form-group">
                        <!-- <label for="exampleFormControlSelect1">Seleccione</label> -->
                        <select class="form-control  " ng-model="proveedor.cod_proveedor" id="proveedor" data-live-search="true">
                          <option value="null" >Todos</option>
                          <option ng-repeat="x in listProveedores" value="{{x.cod_proveedor}}">{{x.nombre_proveedor}}</option>
                          <option value="" disabled selected>Seleccione un proveedor</option>
                        </select>
                      </div>
                    </div>
                  </div>
        
                  <div class="col-md-3">
                    <label for="filtro">Filtrar por tipo</label>
                    <div class="input-group mb-3 ">
                      <div class="form-group">
                        <!-- <label for="exampleFormControlSelect1">Seleccione</label> -->
                        <select class="form-control   " ng-model="clasificacion.CODIGO" id="proveedor" data-live-search="true" >
                          <!-- <option value="null" >Todos</option> -->
                          <option ng-repeat="x in listClasificaciones" value="{{x.CODIGO}}">{{x.NOMBRE}}</option>
                          <option value="" disabled selected>Seleccione un tipo</option>
                        </select>
                      </div>
                    </div>
        
                  </div>

                  <div class="col-md-3">
                    <label for="filtro">Filtrar por categoría</label>
                    <div class="input-group mb-3 ">
                      <div class="form-group">
                        <!-- <label for="exampleFormControlSelect1">Seleccione</label> -->
                        <select class="form-control" ng-model="categoria" id="categoria"
                        ng-options="option.NOMBRE for option in listCategorias track by option.CODIGO" 
                        ng-change="getSubCategorias()" >
                          <!-- <option value="null" >Todos</option> -->
                          <!-- <option ng-repeat="x in listCategorias"  ng-click="getSubCategorias(x)" value="{{x.CODIGO}}">{{x.NOMBRE}}</option> -->
                          <option value="" disabled selected>Seleccione una categoría</option>
                        </select>
                      </div>
                    </div>
        
                  </div>

                  <div class="col-md-3">
                    <label for="filtro">Filtrar por sub-categoría</label>
                    <div class="input-group mb-3 ">
                      <div class="form-group">
                        <!-- <label for="exampleFormControlSelect1">Seleccione</label> -->
                        <select class="form-control" ng-model="subCategoria.CODIGO" id="sub_categoria" data-live-search="true" ng-disabled="categoria.CODIGO==null|| categoria.CODIGO=='T'">
                          <!-- <option value="null" >Todos</option> -->
                          <option ng-repeat="x in listSubCategorias"  value="{{x.CODIGO}}">{{x.NOMBRE}}</option>
                          <option value="" disabled selected>Seleccione una sub categoría</option>
                        </select>
                      </div>
                    </div>
        
                  </div>


        
                </div>
              </div>

          </div>


          <div class="modal-body-he">
            <button id="btnProductInfo" style="display:none" data-toggle="modal" data-target="#modalInfoProduct"></button>
            <div class="">

              <div class="col-sm-12 col-md-12 col-lg-12">


              </div>

                <div ng-if="showProductTable" >

                  <table datatable="ng" id="tableProd" dt-options="dtOptionsProd"  class="table table-sm" style="overflow: hidden !important;" >
                    <!-- <table  class="table table-sm" style="overflow: hidden !important;" > -->
                    <thead>
                        <tr>
                        <th scope="col"><p class="text-center">#</p></th>
                        <th scope="col" ng-show="mostrarImagenges " ><p class="text-center">Imagen</p></th>
                        <th scope="col"><p class="text-center">Nombre producto</p></th>
                        <th scope="col"><p class="text-center">Categoría</p></th>
                        <th scope="col"><p class="text-center">Existencia</p></th>
                        <th scope="col"><p class="text-center">Cantidad</p></th>
                        <th scope="col"><p class="text-center">Oferta</p></th>
                        <th scope="col"><p class="text-center">Precio Bs.</p></th>
                        <th scope="col"><p class="text-center">IVA Bs.</p></th>
                        <th scope="col"><p class="text-center">Precio USD</p></th>
                        <th scope="col"><p class="text-center">IVA USD</p></th>
                        <th scope="col"><p class="text-center">Principio activo</p></th>
                        <th scope="col"><p class="text-center">Proveedor</p></th>
                        <th scope="col"><p class="text-center">Opciones</p></th>
                        </tr>
                    </thead>
                    <tbody>

                        <tr ng-repeat="x in productos"  ng-class="{ selectedRow : $index == productIndex }"    >

                            <td ng-click="selectProduct($index,true)" ><p class="text-left">{{ $index + 1 }}</p></td>
                            
                            <td ng-show="mostrarImagenges " ng-click="selectProduct($index,true)" >
                              <div ng-if="x.dir_imagen != ''" style="cursor: pointer;" ng-click="zoomImg('/'+x.dir_imagen, x.nombre_producto )"   >
                                <img id="img_{{$index}}" ng-src=" http://web.del-oeste.com/app/assets/imagen/{{ x.dir_imagen }}" alt="no image" on-error="http://web.del-oeste.com/app/assets/nopic.png"  style="width: 120px;">
                              </div>
                            </td>
                            <td ng-click="selectProduct($index,true)" style="	white-space: normal !important;"><p class="text-left">{{ x.nombre_producto }}</p></td>
                            <td ng-click="selectProduct($index,true)" ><p class="text-left">{{ x.categoria }}</p></td>
                            <td ng-click="selectProduct($index,true)" ><p class="text-right">{{ x.existencia }}</p></td>
                            <td ng-click="selectProduct($index,true)"  >
                              <div ng-if="$index == productIndex">
                                <input id="cantidad_{{$index}}" type="number" min="0" max="{{x.existencia}}" style=" width: 90px !important; display: inline-block !important;"  ng-model="articulo.CANTIDAD"
                                 ng-keydown="$event.keyCode === 13 && addArtPedido(true)"
                                 ng-blur="validaBlur(articulo.CANTIDAD)"
                                class="form-control" placeholder="cantidad" onkeypress='return event.charCode >= 48 && event.charCode <= 57' >
                                <button type="button"  class="btn btn-success"   ng-click="addArtPedido(true)" ><i class="fas fa-check"  ></i> </button>

                              </div>
                              <div ng-if="$index != productIndex" >
                                <input type="text" class="form-control" ng-click="selectProduct($index,true)" style=" width: 90px !important;" ng-disabled="true" >
                              </div>
                            </td>
                            <td ng-click="selectProduct($index,true)" ><p class="text-right">{{  x.descuento1 }} %</p></td>
                            <td ng-click="selectProduct($index,true)" ><p class="text-right">{{  formato(1,x.precio_neto_bs) }}</p></td>
                            <td ng-click="selectProduct($index,true)" ><p class="text-right">{{  formato(1,x.iva_bs) }}</p></td>
                            <!-- <td ng-click="selectProduct($index,true)" ><p class="text-right">{{  formato(3,x.precio_neto_usd) }}</p></td>
                            <td ng-click="selectProduct($index,true)" ><p class="text-right">{{  formato(3,x.iva_usd) }}</p></td> -->

                            <td ng-click="selectProduct($index,true)" ><p class="text-right">{{x.precio_neto_usd }}</p></td>
                            <td ng-click="selectProduct($index,true)" ><p class="text-right">{{x.iva_usd }}</p></td>
                            <td ng-click="selectProduct($index,true)" style="	white-space: normal !important;" ><p class="text-left">{{ x.princ_activo }}</p></td>
                            <td ng-click="selectProduct($index,true)" style="	white-space: normal !important;" ><p class="text-left">{{  x.proveedor }}</p></td>
                            <td ><i class="fa fa-eye" style="cursor: pointer;"  ng-click="selectProduct($index)" ></i></td>

                        </tr>

                    </tbody>
                    </table>
                </div>


            </div>

            </div>

        </div>
        <div class="modal-footer">

          <button type="button" class="btn btn-info" data-dismiss="modal" ng-click="closeModalProducts()" >Regresar</button>

        </div>
      </div>
    </div>
  </div>

  <div class="modal show" id="modalInfoProduct">
    <div class="modal-dialog mw-100  modal-90 modal-100-ht">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title" style="text-transform: capitalize;" >{{articulo.nombre_producto.toLowerCase()}}</h4>
          <button type="button" class="close" ng-click="closeModalInfoProduct()" data-dismiss="modal" aria-hidden="true">&times;</button>

        </div>
        <div class="modal-body">

          <div class="container">
            <nav aria-label="breadcrumb" role="navigation">
              <ol class="breadcrumb m-0">
                <li class="breadcrumb-item"><a class="text-info" >{{articulo.categoria}}</a></li>
                <li class="breadcrumb-item"><a class="text-info">{{articulo.division}}</a></li>
              </ol>
            </nav>
            <div class="row" >

              <div class="col-md-5 col-sm-12">
                <img src="http://web.del-oeste.com/app/assets/imagen/{{ articulo.dir_imagen }}" alt="" style="width: 100%; " >
              </div>
              <div class="col-md-7 col-sm-12">
                <div class="row" >
                  <div class="col-md-12" >

                    <h1 class="product-name cx-heading cx-brand-font bold larger">{{articulo.nombre_producto.toLowerCase()}} <span style="font-size: small; color: gray;"> {{articulo.princ_activo}}</span></h1>

                  </div>

                  <div class="col-md-12" ng-if="editProduct">
                    <label>Cantidad</label>
                    <input type="number"  ng-model="articulo.CANTIDAD"
                    ng-keydown="$event.keyCode === 13 && addArtPedido(true)"
                     class="form-control" placeholder="Cantidad" onkeypress='return event.charCode >= 48 && event.charCode <= 57' >
                     <button type="button" ng-disabled="productIndex==-1" class="btn btn-success" style="margin-top: 32px;" ng-click="addArtPedido();">Agregar</button>

                  </div>

                </div>
                <div class="row" style="border-top: 1px solid #ccc;
                padding-top: 10px;
                margin-top: 10px;" >
                  <div class="col-md-6" >
                    <p class="mb-1"><span class="text-muted">Principio activo: </span> {{articulo.princ_activo}}</p>
                    <p class="mb-1"><span class="text-muted">Fecha vencimiento: </span> {{articulo.fecha_vence}}</p>
                    <p class="mb-1"><span class="text-muted">Proveedor: </span> {{articulo.proveedor}}</p>
                    <p class="mb-1"><span class="text-muted">Categoría: </span> {{articulo.categoria}}</p>
                    <p class="mb-1"><span class="text-muted">División: </span> {{articulo.division}}</p>
                  </div>
                  <div class="col-md-6 ">
                    <!-- <p class="font-weight-bold mb-4">Detalles</p> -->
                    <!-- <p class="mb-1" ng-if="clienteEmpleado" ><span class="text-muted">Tipo (empleado): </span> {{articulo.tipo_prod_emp}}</p> -->
                    <p class="mb-1"><span class="text-muted">Regulado: </span> {{articulo.ind_regulado}}</p>
                    <p class="mb-1"><span class="text-muted">Impuesto: </span> {{articulo.ind_impuesto}}</p>
                    <p class="mb-1"><span class="text-muted">Psicotrópico: </span> {{articulo.ind_psicotropico}}</p>
                    <p class="mb-1"><span class="text-muted">Existencia: </span> {{articulo.existencia}}</p>
                    <p class="mb-1"><span class="text-muted">Unidad de Manejo: </span> {{articulo.unidad_manejo}}</p>
                    <p class="mb-1"><span class="text-muted">Oferta: </span> {{articulo.descuento1}} %</p>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-12" style="border-top: 1px solid #ccc;
                  padding-top: 10px;
                  margin-top: 10px;"  >
                    <!-- <span class="product-price-lowest">$44.99</span> -->
                    <h4 class="product-price-lowest text-right" >{{formato(2,(articulo.precio_neto_bs)? articulo.precio_neto_bs:0)}}</h4>
                  </div>
                  <div class="col-md-12" >
                    <h4  class="product-price-lowest text-right" >{{formato(3,(articulo.precio_neto_usd)? articulo.precio_neto_usd:0)}}</h4>

                  </div>
                </div>

              </div>
            </div>
          </div>

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-info" ng-click="closeModalInfoProduct()" data-dismiss="modal">Regresar</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="modalConfirmDynamic" style="z-index: 10000 !important ;">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header {{modalheaderColor}}" >
          <h4 class="modal-title">{{ modalDynTitle }}</h4>
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>

        </div>
        <div class="modal-body">

          <div class="container">

            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <h5><p class="text-center">{{ modalDynMsg }}</p></h5>
            </div>

          </div>

        </div>
        <div class="modal-footer">
          <button type="button" class="btn {{modalCancelColor}}" data-dismiss="modal" ng-click="cancelModalDyn()" >No</button>
          <button type="button" class="btn btn-{{modalDynColor}}" ng-click="aceptModalDyn()" data-dismiss="modal">Sí</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="modalImg">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">{{ imgTitle }}</h4>
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>

        </div>
        <div class="modal-body">

          <div class="container">

            <img class="my-modal-content" id="img01" src="http://web.del-oeste.com/app/assets/imagen/{{viewImg}}" >

          </div>

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" data-dismiss="modal"  >Cerrar</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="shoppingCart">
    <div class="modal-dialog mw-100">
      <div class="modal-content">
        <div class="modal-header">
          <!-- <h4 class="modal-title">Carrito</h4> -->
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>

        </div>
        <div class="animated fadeIn   p-3 rounded cart" style="height: 500px;overflow-x: hidden;">
          <div class="row no-gutters">
              <div class="col-md-12">
                  <div class="product-details mr-2">
                    
                      <div class="d-flex justify-content-between"><span>Usted tiene {{totales.totalUnidades}} items en su carrito</span>
                          <!-- <div class="d-flex flex-row align-items-center"><span class="text-black-50">Sort by:</span>
                              <div class="price ml-2"><span class="mr-1">price</span><i class="fa fa-angle-down"></i></div>
                          </div> -->
                      </div>

                      <div  class="d-flex justify-content-between align-items-center mt-3 p-2 items rounded row">
                        <div class="d-flex flex-row col-md-7">
                          <!-- <img class="rounded" src="/assets/nopic.png" width="40"> -->
                            <div class="ml-2"><span class="font-weight-bold d-block">Descripcion</span></div>
                        </div>
                        <div class="d-flex flex-row align-items-center col-md-5 row">
                          <div class="col-md-2" > 
                            <span class="" style=" font-size: 12px; " >Cantidad</span>
                          </div>
                          <div class="col-md-3" > 
                            <span class="" style=" font-size: 12px;">Precio Bs</span>
                          </div>
                          <div class="col-md-3" > 
                            <span class="" style=" font-size: 12px;" >Precio $</span>
                          </div>

                          <div class="col-md-2" > 
                            <span class="" style=" font-size: 12px;" >Opcines</span>
                          </div>

                        </div>
                    </div>

                    
                      <div ng-repeat="x in pedido.pedido" class="d-flex justify-content-between align-items-center mt-3 p-2 items rounded row">
                        <div class="d-flex flex-row col-md-7">
                          <!-- <img class="rounded" src="/assets/nopic.png" width="40"> -->
                            <div class="ml-2"><span class="font-weight-bold d-block">{{ x.nombre_producto }}&nbsp;</span></div>
                        </div>
                        <div class="d-flex flex-row align-items-center col-md-5 row">
                          <div class="col-md-2" > 
                            <span class="" style=" font-size: 12px;" >{{ x.CANTIDAD }}</span>
                          </div>
                          <div class="col-md-3" > 
                            <span class="" style=" font-size: 12px;">{{ formato(2,(x.precio_neto_bs * x.CANTIDAD)) }}</span>
                          </div>
                          <div class="col-md-3" > 
                            <span class="" style=" font-size: 12px;" >{{ formato(3,(x.precio_neto_usd * x.CANTIDAD)) }}</span>
                          </div>
                          <div class="col-md-2" > 
                            <span class="" style=" font-size: 12px;" >
                              <i class="fa fa-trash" style="cursor: pointer;"  ng-click="openModalDyn(3,$index);" ></i>
                            </span>
                          </div>

                        </div>
                    </div>
                    <div ng-if="ID != null" class="row mt-5">
                      <div class="col-lg-2 col-sm-5">
                        </div>
                          <div class="col-lg-6 col-sm-6 ml-auto">
                              <table class="table table-clear tablaTotales">
                                  <tbody>
                                        <tr>
                                          <td class="right">
                                              <strong class="text-dark">TOT. UNID. PEDIDO :</strong> </td>
  
                                              <td class="right">{{totales.totalUnidades}} </td>
                                      </tr>
                                          <tr ng-if=" totalesDdo.desc_volumen > 0">
                                            <td class="right">
                                                <strong class="text-dark">TOT. DESC. PP1. {{totalesDdo.porcVol}} %:</strong> </td>
  
                                                <td class="right">{{formato(2,totalesDdo.desc_volumen)}} </td>
                                        </tr>
                                        <tr ng-if=" totalesDdo.desc_dpp > 0">
                                          <td class="right">
                                              <strong class="text-dark">TOT. DESC. PP2. {{totalesDdo.porcPP}} %:</strong> </td>
  
                                              <td class="right">{{formato(2,totalesDdo.desc_dpp)}} </td>
                                      </tr>
                                      <tr ng-if=" totalesDdo.descPreEmpaque > 0">
                                        <td class="right">
                                            <strong class="text-dark">TOT. DESC. PREEMP. :</strong> </td>
  
                                            <td class="right">{{formato(2,totalesDdo.descPreEmpaque)}} </td>
                                    </tr>
                                      <tr>
                                          <td class="right">
                                              <strong class="text-dark">SUB.T. (E):</strong> </td>
  
                                              <td class="right">{{formato(2,totalesDdo.totalExento)}} </td>
                                      </tr>
                                      <tr>
                                        <td class="right">
                                            <strong class="text-dark">SUB.T. (G):</strong> </td>
  
                                            <td class="right">{{formato(2,totalesDdo.totalGravado)}} </td>
                                      </tr>
                                      <tr ng-if="totalesDdo.descImpuesto != null || totalesDdo.impuesto > 0">
                                          <td class="right">
                                            
                                              <strong class="text-dark">{{totalesDdo.descImpuesto }} </strong> </td>
  
                                              <!-- <td class="right">% {{totalesDdo.impuesto }} {{formato(2,totalesDdo.descImpuesto)}} </td> -->
                                              <td class="right"> {{formato(2,totalesDdo.impuesto) }} </td>
                                      </tr>
                                      <tr>
                                          <td class="right">
                                              <strong class="text-dark">TOTAL Bs.:</strong> </td>
  
                                              <td class="right"> {{formato(2,totalesDdo.total)}} </td>
                                      </tr>
                                      <tr>
                                        <td class="right">
                                            <strong class="text-dark">TOTAL USD:</strong> </td>
  
                                            <td class="right"> {{ formato(3,totalesDdo.totalNetoUSD) }}  </td>
                                    </tr>
                                  </tbody>
                              </table>
                          </div>
                      </div>

                  </div>
              </div>

          </div>
      </div>
      <div class="modal-footer">
        <div class="d-flex justify-content-between"><span>Usted tiene {{totales.totalUnidades}} items en su carrito</span>
          <!-- <div class="d-flex flex-row align-items-center"><span class="text-black-50">Sort by:</span>
              <div class="price ml-2"><span class="mr-1">price</span><i class="fa fa-angle-down"></i></div>
          </div> -->
      </div>
        <button type="button" class="btn btn-primary" data-dismiss="modal"  >Cerrar</button>
      </div>
      </div>
    </div>
  </div>


  <div class="modal fade" id="modalOferta">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Oferta</h4>
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>

        </div>
        <div class="modal-body">

          <div class="container">

            <!-- <img class="my-modal-content" id="img01" src="http://web.del-oeste.com/app/assets/imagen/{{viewImg}}" > -->

            <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">

              <ol class="carousel-indicators">
                <li data-target="#carouselExampleIndicators" ng-repeat="x in listOfertas" data-slide-to="{{$index}}" ng-class="{ active : $index == carouselOfertasIndex }"></li>
              </ol>
              <div class="carousel-inner">
                <!-- <div class="carousel-item active">
                  <img class="d-block w-100" src="http://web.del-oeste.com/app/assets/nopic.png" alt="First slide">
                </div> -->
                <div ng-repeat="x in listOfertas"  class="carousel-item" ng-class="{ active : $index == carouselOfertasIndex }" >
                  <img class="d-block w-100" src="http://web.del-oeste.com/app/assets/imagen/{{x.nombre_flayer}}" alt="Second slide">
                </div>

              </div>
              <a class="carousel-control-prev" ng-click="prevImgOferta()" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
              </a>
              <a class="carousel-control-next" ng-click="nextImgOferta()" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
              </a>
            </div>

          </div>

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" ng-click="validaOferta()" >Comprobar oferta</button>
          <button type="button" class="btn btn-primary" data-dismiss="modal"  >Cerrar</button>
        </div>
      </div>
    </div>
  </div>


  <div class="modal fade" id="modalConfirm">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Confirmación</h4>
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>

        </div>
        <div class="modal-body">

          <div class="container">

            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <h3><p class="text-center">Desea eliminar el registro?</p></h3>
            </div>

          </div>

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-info" data-dismiss="modal">No</button>
          <button type="button" class="btn btn-danger" ng-click="delPedido()" data-dismiss="modal">Si</button>
        </div>
      </div>
    </div>
  </div>

  <div id="wrapper" class="toggled">

    <my-sidebar></my-sidebar>
    <div id="page-content-wrapper" class="container-fluid">
      <div class="row" style="min-height:80vh">

        <div class="col-md-12 col-sm-12">
          <!-- <br>
          <h5 class="text-center"> <strong>PEDIDOS </strong> </h5>
          <br> -->

          <nav aria-label="breadcrumb" role="navigation">
            <ol class="breadcrumb m-0">
              <li class="breadcrumb-item"><a class="text-success" >Droguería del Oeste.com</a></li>
              <li class="breadcrumb-item"><a class="text-info" href="#!/home">Inicio</a></li>
              <li class="breadcrumb-item active" aria-current="page">Pedidos</li>
            </ol>
          </nav>
          <!-- <h3><timer countdown="10" interval="1000">{{countdown}}</timer></h3> -->
          <!-- <button ng-click="add5Seconds()">Add 5 Seconds</button> -->

          <header-client ></header-client>

          <div ng-show="!hasUserClient">
            <div class="row" style="margin-bottom: 15px;">
              <div class="col-md-12">
                <div class="card " >
                  <div class="card-body">
                    <h5 class="card-title">Búsqueda por cliente </h5>

                    <div class="form-check mb-3">
                      <input class="form-check-input" type="radio" name="exampleRadios" ng-model="tipoBusquedaCliente" id="exampleRadios1" ng-value="0" selected >
                      <label class="form-check-label" for="exampleRadios1">
                        Búsqueda por cliente
                      </label>
                    </div>
                    <div class="form-check mb-3">
                      <input class="form-check-input" type="radio" name="exampleRadios" ng-model="tipoBusquedaCliente" id="exampleRadios2" ng-value="1" >
                      <label class="form-check-label" for="exampleRadios2">
                        Búsqueda por empleado
                      </label>
                    </div>

                    <div class="row">
                      <div class="col-sm-12 col-md-6 col-lg-6">
                        <!-- <label for="clientes">Busqueda por cliente</label> -->
                        <div class="input-group mb-3">
                          <input type="text" id="clientes"
                          class="form-control"
                          ng-keydown="$event.keyCode === 13 && getClientNew(true)"
                          ng-model="nombre_cliente"
                          placeholder="Búsqueda por cliente"
                          aria-label="Búsqueda por cliente"
                          aria-describedby="basic-addon2">
                          <div class="input-group-append">
                            <button class="btn btn-outline-secondary"  ng-click="getClientNew(true)" type="button">Buscar</button>
                          </div>
                        </div>
                      </div>
                      <div class="col-sm-12 col-md-6 col-lg-6" ng-show="clientes.length > 0" >
                        <div class="form-group">
                          <!-- <label for="exampleFormControlSelect1">Seleccione</label> -->
                          <select class="form-control" ng-model="clientIndex" id="exampleFormControlSelect1" ng-focus="clientIndex = null" ng-change="selectCLient()">
                            <option ng-repeat="x in clientes" value="{{$index}}">{{x.nombre_cliente}}</option>
                            <option value="" disabled selected>Seleccione un cliente</option>
                          </select>
                        </div>
                      </div>

                    </div>

                  </div>
                </div>
              </div>

            </div>

            <div ng-if="clientIndex != null">
              <header-client cliente="client" ></header-client>
            </div>



          </div>

          <div class="">

            <div class="col-md-12 mt-10 mb-10">
              <div class="card " >
                <div class="card-body">
                  <div class="row">

                    <div id="card__infoicon">

                      <div class="alert alert-psico alert-dismissible fade show" ng-show="infoPsico" role="alert">
                        <div>
                          
                          <p>Los pedidos de Psicotr&oacute;picos se canalizan directamente en DDO, suministrando la informaci&oacute;n solicitada a Regencia.</p>
                          <p>Enviar la siguiente documentación legible al siguiente correo electrónico : <a href="mailto:regencia@del-oeste.com" target="_blank" rel="noopener" >regencia@del-oeste.com</a> :</p>
                          <ul>
                            <li><p>C&eacute;dula de identidad del Regente.</p></li>
                            <li><p>T&iacute;tulo del Farmac&eacute;utico.</p></li>
                            <li><p>Permiso de Funcionamientos actualizado.</p></li>
                            <li><p>Última Relación de Psicotrópicos firmada y sellada, si es enviada por correo electrónico, copia de envió y acuse de hacer sido recibida por parte del Servicio Autónomo de Controlaría Sanitaria.</p></li>
                            <li><p><a href="http://web.del-oeste.com/app/assets/planilla.doc" target="_self" download="planilla.doc">Planilla de solicitud&nbsp;</a>de productos Psicotrópicos firmada por el Regente y sellada por la Farmacia, con la fecha actual, es exigido por el Servicio Autónomo de Controlaría Sanitaria (ver anexo).</p></li>
                          </ul>
                          <p>Todos los documentos exigidos deben ser enviados al mismo correo electrónico del Regente.</p>

                          
                        </div>
                        <button type="button" class="close"  ng-click="infoPsico = false" >
                          <span aria-hidden="true">&times;</span>
                        </button>
                      </div>
                    </div>
                    <div class="col-md-6 col-sm-12" >

                      <button class="btn btn-naranja"  ng-show="!clienteEmpleado" style="float: left; font-weight: bold;margin-bottom: 1rem; width: 100%;" ng-click="infoPsico = true;" ng-show="!infoPsico"  > <i class="fa fa-info-circle"></i> Requisitos para Psicotrópico</button>
                    </div>

                    <div class="col-md-6 col-sm-12" ng-show="showProductTable || hasUserClient"  >
                      <!-- userLogged.pedido.crear :{{userLogged. }} -->
                      <button class="btn btn-primary" style="float: right; font-weight: bold;margin-bottom: 1rem; width: 100%;" ng-click="initModal();"  ng-if="userLogged.permisos.pedido.crear"  ng-disabled="!clienteValido" ng-show="!unicOrderID"  > <i class="fa fa-edit"></i> Crear pedido</button>
                      <button class="btn btn-primary" style="float: right; font-weight: bold;margin-bottom: 1rem; width: 100%;" ng-click="getPedido(unicOrderID, origenPedido);" ng-disabled="!clienteValido" ng-show="unicOrderID"  > <i class="fa fa-edit"></i>Continuar Pedido </button>

                    </div>

                    <div class="col-md-12">

                      <div class="alert alert-gris alert-dismissible fade show"  role="alert">
                        <strong><i class="fas fa-info-circle"></i></strong> Los pedidos que se encuentran en <strong>construcción</strong> tendrán un tiempo máximo de <strong>dos (2) horas</strong>. Si usted no cierra el pedido dentro de ese intervalo de tiempo, este será <strong>cancelado</strong> y las unidades reservadas para los productos del pedido serán liberadas.

                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                          <span aria-hidden="true">&times;</span>
                        </button>
                      </div>

                      <div class="alert alert-gris alert-dismissible fade show" ng-show="msgOrdCancel" role="alert">
                        <strong>¡Advertencia!</strong> Dispone de menos de 15 minutos para finalizar su pedido de lo contrario será cancelado por el sistema.
                      </div>
                    </div>

                    <div class="btn-group col-md-12" role="group" aria-label="Basic outlined example" style="margin-bottom: 15px;">
                      <button type="button" ng-click="listMode=0; filterList()" class="btn btn-outline-primary" ng-class="{ active : listMode == 0 }" >Ultima semana</button>
                      <button type="button" ng-click="listMode=1; filterList()" class="btn btn-outline-primary" ng-class="{ active : listMode == 1 }">Hoy</button>
                      <button type="button" ng-click="listMode=2" class="btn btn-outline-primary" ng-class="{ active : listMode == 2 }">Seleccione fecha</button>
                    </div>

                    <div class="col-md-3" ng-show="listMode==2">
                      <!-- <label for="date" class="col-sm-1 col-form-label">Date</label> -->
                      <div class="input-group date" id="dateStart">
                          <input type="text" class="form-control" ng-model="dateStart" placeholder="Inicio">
                          <span class="input-group-append">
                          <span class="input-group-text bg-white d-block">
                          <i class="fa fa-calendar"></i>
                          </span>
                          </span>
                      </div>
                  </div> 
                  <div class="col-md-3" ng-show="listMode==2">
                    <!-- <label for="date" class="col-sm-1 col-form-label">Date</label> -->
                    <div class="input-group date" id="dateEnd">
                        <input type="text" class="form-control" ng-model="dateEnd" placeholder="Fin">
                        <span class="input-group-append">
                        <span class="input-group-text bg-white d-block">
                        <i class="fa fa-calendar"></i>
                        </span>
                        </span>
                    </div>
                </div> 

                <div class="col-md-6 col-sm-12" ng-show="listMode==2"  >
                  <button class="btn btn-primary" style="float: right; font-weight: bold;margin-bottom: 1rem; width: 100%;" ng-click="filterList(dateStart,dateEnd);"  > <i class="fa fa-search"></i> Buscar</button>
                </div>

                    <div class="col-md-12">


                      <table class="table table-striped table-bordered"  datatable="ng" dt-options="dtOptions">
                        <thead>
                          <tr>
                            <th scope="col"><p class="text-center">#</p></th>
                            <th scope="col"><p class="text-center">Nº pedido</p></th>
                            <th scope="col"><p class="text-center">Fecha creación</p></th>
                            <th  ng-show="!hasUserClient" scope="col"><p class="text-center">Nombre cliente</p></th>
                            <!-- <th scope="col"><p class="text-center">Direcion</p></th> -->
                            <th scope="col"><p class="text-center">Estatus</p></th>
                            <th scope="col"><p class="text-center">Fecha actualización</p></th>
                            <th scope="col"><p class="text-center">Tipo pedido</p></th>
                            <th scope="col"><p class="text-center">Tiempo pedido</p></th>
                            <th scope="col"><p class="text-center">Opciones</p></th>
                          </tr>
                        </thead>
                        <tbody>

                          <tr ng-repeat="x in listaPedidosV2filter" ng-show="x.estatus != 'PEDIDO CREADO'">
                            <th scope="row"><p class="text-center">{{ $index + 1 }}</p></th>
                            <td><p class="text-left">ORD-{{ x.ID }}{{(x.origen_pedido=='WEB')? '-WEB':''}}</p></td>
                            <td><p class="text-left">{{  x.fecha_creacion }}</p></td>
                            <td ng-show="!hasUserClient" ><p class="text-left">{{ x.nombre_cliente }}</p></td>
                            <!-- <td><p class="text-left">{{ x.direccion_cliente }}</p></td> -->
                            <td><p class="text-left">{{ x.estatus }}</p></td>
                            <td><p class="text-left">{{ x.fecha_estatus }}</p></td>
                            <td><p class="text-left">{{ x.tipo_pedido }}</p></td>
                            <td>
                              <div ng-if="timerRunning && (x.estatus == 'PEDIDO EN CONSTRUCCION' || x.estatus == 'PEDIDO EN EDICION' ) ">
                                <timer countdown="liveTimeOrd" interval="1000">{{hours}}:{{minutes}}:{{seconds}}</timer>
                              </div>
                            </td>
                            <td>

                              <i class="fa fa-trash" style="cursor: pointer;"  ng-if="userLogged.permisos.pedido.eliminar" ng-show="x.estatus =='PEDIDO EN CONSTRUCCION' || x.estatus =='PEDIDO CREADO' || x.estatus == 'POR PROCESAR'" data-toggle="modal" data-target="#modalConfirm" ng-click="confirmModal(x.ID);"  ></i>

                              <i class="fa fa-eye" style="cursor: pointer;"  ng-click="getPedido(x.ID,x.origen_pedido);" data-toggle="modal" data-target="#showPedidoModal"  ></i>

                              <!-- <i class="fa fa-clock" style="cursor: pointer;"   ng-show="x.estatus =='PEDIDO EN CONSTRUCCION' || x.estatus =='PEDIDO CREADO' || x.estatus == 'POR PROCESAR'"  ng-click="tiempoPedido(x.ID);"  ></i> -->

                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>

                  </div>

                </div>
              </div>
            </div>

          </div>

        </div>
      </div>


    </div>
  </div>

  <my-footer></my-footer>
  <!-- <div ng-show="loading"> -->
    <my-loading></my-loading>
  <!-- </div> -->
 <!-- <error-Overlay></error-Overlay> -->